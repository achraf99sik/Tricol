<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">
    <changeSet id="5" author="achraf">
        <createTable tableName="stock_movements">
            <column name="id" type="UUID" defaultValueComputed="gen_random_uuid()">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="date" type="TIMESTAMP"/>
            <column name="quantity" type="INT"/>
            <column name="type" type="VARCHAR(20)"/> <!-- ENTREE, SORTIE, AJUSTEMENT -->
            <column name="supplier_order_id" type="UUID"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP"/>
        </createTable>
        <addForeignKeyConstraint
                baseTableName="stock_movements"
                baseColumnNames="supplier_order_id"
                referencedTableName="supplier_orders"
                referencedColumnNames="id"
                constraintName="fk_stock_movement_order"/>
        <modifySql dbms="h2">
            <replace replace="gen_random_uuid()" with="random_uuid()"/>
        </modifySql>
    </changeSet>
</databaseChangeLog>